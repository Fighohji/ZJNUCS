var common = {
  init: function() {
    this.handleHover();
  },
  handleHover: function() {
    $(".navUl>li:first").addClass("parent");

    // 内页截图

    var container4 = ".teacher-info .teacher-sence-a .img-wrap";
    var selector4 = ".teacher-info .teacher-sence-a .img-wrap>img";
    PictureProcessing.cutting(selector4, container4, 207, 167);
    //菜单栏hover
    var timer = null;
    // 导航
    $(".menu>ul>li").hover(
      function() {
        var that = $(this);

        timer = setTimeout(function() {
          //that.find('ul').slideDown(200);
          that.children("ul").slideDown(200);
        }, 200);
      },
      function() {
        var that = $(this);
        //that.find('ul').slideUp(200);
        that.children("ul").slideUp(200);
        clearTimeout(timer);
      }
    );
    // 搜索框
    $(".searchValue").focus(function() {
      var iptValue = $(this).val();
      if (iptValue == "搜索") {
        var iptNull = "";
        $(this).val(iptNull);
      }
    });
    $(".searchValue").focusout(function() {
      var iptValue = $(this).val();
      if (iptValue == "") {
        $(this).val("搜索");
      }
    });

    var overlay = $(".overlay"); //透明遮罩
    // 移动端导航显示与隐藏
    function phoneMenu() {
      $("#page-content-wrapper").toggleClass("toggled");
      if (overlay.is(".is-open")) {
        // 头部
        $(".search,.ch,.en").css("display", "none");
        // $(".search,.ch,.en").css("display", "block");
        $(".menu-icon")
          .addClass("open")
          .removeClass("m-close");
        $("#page-content-wrapper").css("width", "100%");
        $(".phone-menu").css("right", "-284px"); //
        overlay.removeClass("is-open");
        $(".header").removeClass("header-show");
        $(".p-menu");
        $("body")
          .height(window_h)
          .css("overflow", "");
        // overlay.height(window_h).css("overflow", "");
      } else {
        overlay.addClass("is-open");

        $(".nav-menu ").remove();
        $(".menu-icon")
          .addClass("m-close")
          .removeClass("open");
        $(".phone-menu").css("right", "0");
        var window_h = $(window).height();
        $("body")
          .height(window_h + 100)
          .css("overflow", "hidden");
        overlay.height(window_h + 100).css("overflow", "hidden");
        $(".header").addClass("header-show"); //header
      }
    }

    //  判断是否有子栏目，显示下拉按钮
    $(".p_menu ul li").each(function() {
      if ($(this).children("ul").length <= 0) {
        $(this)
          .children(".dropdownBtn")
          .remove();
      }
    });
    $(".nav-menu .menu> ul>li").each(function() {
      if ($(this).children("ul").length > 0) {
        $(this)
          .children("a")
          .after("<i class='icon'></i>");
      }
    });
    //手机导航菜单的点击展开下一级
    $(".dropdownBtn").click(function() {
      if (
        $(this)
          .parent("li")
          .is(".is_choose")
      ) {
        $(this)
          .parent("li")
          .removeClass("is_choose");
        $(this)
          .removeClass("fa-minus")
          .addClass("fa-plus");
        $(this)
          .prev("ul")
          .slideUp();
      } else {
        $(this)
          .parent("li")
          .addClass("is_choose");
        $(this)
          .removeClass("fa-plus")
          .addClass("fa-minus");
        $(this)
          .prev("ul")
          .slideDown();
      }
    });

    //pc端是否有下一级

    $(".open").click(function() {
      phoneMenu();
    });
    $(".menu_close").click(function() {
      phoneMenu();
    });
    overlay.click(function() {
      phoneMenu();
    });
    // 师资队伍截图,宽度调整
    function img_change() {
      var li_width = $(
        "section .container-four .main-four .four-content .teacher ul li"
      ).width();
      if (li_width > 356) {
        $(
          "section .container-four .main-four .four-content .teacher ul li .img-wrap"
        ).css("width", "356px");
      } else {
        $(
          "section .container-four .main-four .four-content .teacher ul li .img-wrap"
        ).css("width", "auto");
      }
      // 师资队伍截图
      $(".four-swiper .teacher ul li a .img-wrap>img")
        .attr("style", "width:auto;height:auto")
        .attr("width", "auto"); //初始化
      var container22 = ".four-swiper .teacher ul li a .img-wrap";
      var selector22 = ".four-swiper .teacher ul li a .img-wrap>img";
      PictureProcessing.cutting(selector22, container22, 353, 286);
    }
    window.onload = function() {
//menu去掉下划线
$(".nav-menu .menu>ul>li").each(function(){
    var e=$(this).children("a").children("span").text();
   
    e=e.replace("_","");
    $(this).children("a").children("span").text(e)
    
});
//侧边menu去掉下划线
var d=$(".list-left .left-menu .left-title .ch-title >span").text();
d=d.replace("_","");
$(".list-left .left-menu .left-title .ch-title >span").text(d);
//去掉下划线
var d1=$(".list-right .right-content .content-top .main-title").text();
d1=d1.replace("_","");
$(".list-right .right-content .content-top .main-title").text(d1);

      //获取年份
      $("#copyright_to_year").html(new Date().getFullYear());
      /* 学术讲座截字*/
      $(".third-swiper .swiper-slide").each(function() {
        var obj = $(this)
          .find(".jianjie")
          .text();

        var c1 = obj.substring(0, obj.indexOf("\\")); //截取开头到包含\\的下标
        var c2 = obj.substring(obj.indexOf("\\") + 2, obj.indexOf("/")); //截取包含截取时包含前字符不包含结尾字符
        var c3 = obj.substring(obj.indexOf("/") + 1);
        $(this)
          .find(".pg")
          .text(c1); //时间
        $(this)
          .find(".pg")
          .next("p")
          .text(c2); //地点
        $(this)
          .find(".pg")
          .next("p")
          .next("p")
          .text(c3); //承办方
      });

      //新闻列表日期显示

      $(
        ".list-list li,.two-list ul li,.right-list ul li,.swiper-container2 .swiper-slide .bottom-title"
      ).each(function() {
        var text = $(this)
          .find(".time")
          .text();

        var day = text.substring(8, 10);

        var month = text.substring(5, 7);

        switch (month) {
          case "01":
            month = "一";
            break;
          case "02":
            month = "二";
            break;
          case "03":
            month = "三";
            break;
          case "04":
            month = "四";
            break;
          case "05":
            month = "五";
            break;
          case "06":
            month = "六";
            break;
          case "07":
            month = "七";
            break;
          case "08":
            month = "八";
            break;
          case "09":
            month = "九";
            break;
          case "10":
            month = "十";
            break;
          case "11":
            month = "十一";
            break;
          case "12":
            month = "十二";
            break;
        }
        month = month + "月";
        $(this)
          .find(".month")
          .text(month);
        $(this)
          .find(".day")
          .text(day);
      });

      // 首页轮播
      var mySwiper = new Swiper(".swiper-container1", {
        autoplay: 5000, //可选选项，自动滑动
        loop: true,

        pagination: ".swiper-container1 .swiper-pagination",
        prevButton: ".swiper-container1 .swiper-button-prev",
        nextButton: ".swiper-container1 .swiper-button-next",
        paginationClickable: true,
        autoHeight: true,
        centeredSlides: true
      });
      // 学院新闻
      var mySwiper2 = new Swiper(".swiper-container2", {
        autoplay: 5000, //可选选项，自动滑动
        loop: true,
        pagination: ".swiper-container2 .swiper-pagination",
        prevButton: ".swiper-container2 .swiper-button-prev",
        nextButton: ".swiper-container2 .swiper-button-next",
        paginationClickable: true,
        autoHeight: true,
        centeredSlides: true
      });

      //学术讲座&师资队伍
      function swiperFn() {
        var w = $(window).width();
        var view;
        var group;
        if (w <= 992) {
          $(".search,.ch,.en").css("display", "none");
          var swiper_width = $(
            "section .main-one .one-content .one-con .swiper-container2"
          ).width();
          // console.log(swiper_width, "sw");
          swiper_height = swiper_width / (588 / 420);
          // console.log(swiper_height, "sh");
          $(".container-first .left-swiper .swiper-slide .left-con>a").height(
            swiper_height
          );
          $(
            "section .main-one .one-content .one-con .swiper-container2 "
          ).height(swiper_height);
        } else if (w > 992) {
          $(".search,.ch,.en").css("display", "block");
          $(".container-first .left-swiper .swiper-slide .left-con>a").height(
            420
          );
        }
        if (w < 768) {
          view = 1;
       group:1;
        } else if (w < 992) {
          view = 2;
group:2;
          // news
        } else {
          view = 3;
group:3;
        }
        var mySwiper3 = new Swiper(".swiper3", {
          slidesPerView: view,
          spaceBetween: 29,
          slidesPerGroup:group,
          // pagination: {
          //   el: ".swiper-pagination3",
          //   clickable: true
          // },
          loop: true,
          loopFillGroupWithBlank: true,
          autoplay: 5000, //可选选项，自动滑动
          prevButton: ".third-swiper .swiper-button-prev",
          nextButton: ".third-swiper .swiper-button-next",
          observer: true, //修改swiper自己或子元素时，自动初始化swiper    重要
          observeParents: true //修改swiper的父元素时，自动初始化swiper  重要
        });
        var mySwiper4 = new Swiper(".swiper4", {
          slidesPerView: view,
          spaceBetween: 29,
          slidesPerGroup: group,
          loop: true,
          loopFillGroupWithBlank: true,
          // pagination: {
          //   el: ".swiper-pagination4",
          //   clickable: true
          // },
          autoplay: 6000, //可选选项，自动滑动
          prevButton: ".four-swiper .swiper-button-prev",
          nextButton: ".four-swiper .swiper-button-next",

          observer: true, //修改swiper自己或子元素时，自动初始化swiper    重要
          observeParents: true //修改swiper的父元素时，自动初始化swiper  重要
        });
      }
      //教师列表截图
      // $(".teacher-list li a .img-wrap>img")
      //   .attr("style", "width:auto;height:auto")
      //   .attr("width", "auto"); //初始化
      var container3 = ".teacher-list li a .img-wrap";
      var selector3 = ".teacher-list li a .img-wrap>img";
      PictureProcessing.cutting(selector3, container3, 285, 231);

      // 表格响应式
     
      $(".main-info-content table,table").each(function() {
        $(this).addClass("table");
        $(this).wrap('<div  class="table-responsive"></div>');
      });
 // banner字体
      function calc_c() {
        var h = $(".main-swiper .swiper-slide").height();
        var h2 = $(
          "section .main-banner .main-swiper .swiper-slide a .b_center"
        ).height();
        var c = (h - h2) / 2;
        $("section .main-banner .main-swiper .swiper-slide a .b_center").css(
          "top",
          c + "px"
        );
      }
 calc_c();
      swiperFn();
      img_change();
      $(window).resize(function() {
        swiperFn();
        img_change();
 calc_c();
      });
    };
  }
};
common.init();
